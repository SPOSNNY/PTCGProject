@{
    ViewData["Title"] = "PTCG卡牌管理系統";
}
@model IEnumerable<PTCGProject.Models.CardModel>

<!DOCTYPE html>
<html>
<head>
    <title>卡牌管理</title>
    <style>
        table {
            width: 100%;
            border-collapse: collapse;
        }

        th, td {
            padding: 8px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }

        th {
            background-color: #f2f2f2;
        }

        .edit-name {
            color: blue;
        }
    </style>

    @section scripts {
        <script>
            $(document).ready(function () {

                $('.edit-name').click(function () {
                    var cardId = $(this).data('card-id');
                    var cardVersion = $(this).data('card-version');

                    $.ajax({
                        url: '@Url.Action("EditCard", "CardManage")',
                        type: 'Post',
                        data: {
                            id: cardId,
                            version: cardVersion
                        },
                        success: function (response) {
                            if (response.redirectUrl) {
                                window.location.href = response.redirectUrl;
                            }
                        },
                        error: function (xhr, status, error) {
                            console.error('AJAX Error:', status, error);
                        }
                    });
                });

                $('.btn-delete').click(function () {
                    var cardId = $(this).data('card-id');
                    var cardVersion = $(this).data('card-version');

                    $.ajax({
                        url: '@Url.Action("DeleteCard", "CardManage")',
                        type: 'Post',
                        data: {
                            id: cardId,
                            version: cardVersion
                        },
                        success: function (response) {
                            if (response.redirectUrl) {
                                window.location.href = response.redirectUrl;
                            }
                        },
                        error: function (xhr, status, error) {
                            console.error('AJAX Error:', status, error);
                        }
                    });
                });

            });

        </script>
    }
</head>

<h1>卡牌管理</h1>

<a asp-action="AddCard">新增卡牌</a>

<table>
    <thead>
        <tr>
            <th>編號</th>
            <th>名稱</th>
            <th>屬性</th>
            <th>類型</th>
            <th>稀有度</th>
            <th>版本</th>
            <th>功能</th>
        </tr>
    </thead>
    <tbody>
        @foreach (var card in Model)
        {
            <tr>
              
                <td>@card.CardId</td>
                <td class="edit-name" data-card-id="@card.CardId" data-card-version="@card.CardVersion">@card.CardName</td>
                <td>@card.CardAttribute</td>
                <td>@card.CardType</td>
                <td>@card.CardRarity</td>
                <td>@card.CardVersion</td>
                <td><button class="btn-delete" data-card-id="@card.CardId" data-card-version="@card.CardVersion">刪除</button></td>
            </tr>
        }
    </tbody>
</table>
